const t=[...document.getElementById("rows").content.children],n=16,e=document.getElementById("reviews"),o=[];for(const t of document.getElementsByClassName("page-controls")){const n=document.createElement("button"),e=document.createElement("button"),c=document.createElement("button"),r=document.createElement("button"),s=document.createElement("button");n.append("0"),c.append("<"),r.append(">"),n.classList.add("pretty"),e.classList.add("pretty"),c.classList.add("pretty"),r.classList.add("pretty"),s.classList.add("pretty"),t.append(n,c,s,r,e),o.push({t:n,o:e,i:c,next:r,l:s})}const c=document.getElementById("score-header"),[r,s]=document.getElementById("filter").children;let i,l,u,d;function a(e,s){let d;if(i=e,l=s,r.value=s,history.replaceState(null,"",location.origin+location.pathname+(""===s?"":`?q=${s}`)),null!==s){const n=s.toLowerCase().split(" ");d=t.filter((t=>{const e=t.content.firstElementChild.textContent.toLowerCase();return n.every((t=>e.includes(t)))}))}else d=[...t];if(null!==e)switch(d.sort(((t,n)=>{const o=t=>{const n=t.content.firstElementChild.getElementsByClassName("score")[0];if(void 0===n)return 1/0;const o=parseFloat(n.textContent);switch(e.direction){case"ascending":return o;case"descending":return-o;default:throw new Error(`unknown sort direction ${e.direction}`)}};return o(t)-o(n)})),e.direction){case"ascending":c.textContent="Score ↑";break;case"descending":c.textContent="Score ↓"}else c.textContent="Score ↕";u=[];for(let t=0;t<d.length;t+=n)u.push(d.slice(t,t+n));0===u.length&&u.push([]);for(const{o:t}of o)t.replaceChildren(u.length-1);f(0)}function f(t){e.replaceChildren();for(const n of u[t])for(const t of n.content.children)e.append(t.cloneNode(!0));for(const{t:n,o:e,i:c,next:r,l:s}of o)0===t?(n.disabled=!0,c.disabled=!0):0===d&&(n.disabled=!1,c.disabled=!1),t===u.length-1?(e.disabled=!0,r.disabled=!0):(e.disabled=!1,r.disabled=!1),s.replaceChildren(t);d=t}c.parentElement.addEventListener("click",(()=>{null===i?a({direction:"descending"},l):"descending"===i.direction?a({direction:"ascending"},l):"ascending"===i.direction&&a(null,l)}));for(const{t:t,o:n,i:e,next:c,l:r}of o){t.addEventListener("click",(()=>f(0))),n.addEventListener("click",(()=>f(u.length-1))),e.addEventListener("click",(()=>f(Math.max(0,d-1)))),c.addEventListener("click",(()=>f(Math.min(u.length-1,d+1))));let o=!1;r.addEventListener("click",(()=>{if(o)return;o=!0;const t=document.createElement("input");r.replaceChildren(t);const n=()=>{if(!o)return;o=!1;let n=parseInt(t.value);isNaN(n)?r.replaceChildren(d):(n=Math.max(0,Math.min(u.length-1,n)),n!==d?f(n):r.replaceChildren(d))};t.addEventListener("blur",(()=>n())),t.addEventListener("keypress",(t=>{"Enter"===t.key&&n()})),t.focus()}))}r.addEventListener("input",(()=>a(i,r.value))),s.addEventListener("click",(()=>a(i,""))),a(null,new URLSearchParams(location.search).get("q")||r.value);
